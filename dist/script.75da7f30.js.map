{"version":3,"sources":["api/index.js","script.js"],"names":["getProjectById","id","fetch","then","data","json","getData","url","cacheVersion","cacheName","cacheStorage","caches","open","add","getCachedData","err","console","log","cachedData","cachedResponse","match","ok","deleteOldCaches","currentCache","keys","key","isOurCache","substr","delete","roots","document","querySelectorAll","renderWidget","root","template","integrationName","showBranding","fields","wrapper","createElement","classList","map","row","r","name","indexOf","Number","split","substring","sort","el","el2","order","rowDOM","rowImageWrapper","rowContentWrapper","buttonText","find","buttonUrl","i","length","itemDOM","replace","value","link","linkValue","innerHTML","append","toString","toLowerCase","styles","textFormat","italic","bold","underline","formattedValue","brandingDOM","forEach","loaderStyles","dataset","style","setProperty","primaryColor","secondaryColor","templateSlug"],"mappings":"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","file":"script.75da7f30.js","sourceRoot":"..","sourcesContent":["export const getProjectById = async (id) => {\n  // return await getData();\n  return fetch(`${process.env.LAMBDA_ENDPOINT}/projects/data/${id}`)\n    .then((data) => data.json())\n    .then((data) => {\n      return data;\n    });\n};\nasync function getData(url) {\n  const cacheVersion = 1;\n  const cacheName = `embedtables-${cacheVersion}`;\n  try {\n    const cacheStorage = await caches.open(cacheName);\n    await cacheStorage.add(url);\n    const data = await getCachedData(cacheName, url);\n    return data;\n  } catch (err) {\n    console.log(err);\n    const cachedData = await getCachedData(cacheName, url);\n    if (cachedData) {\n      return cachedData;\n    }\n  }\n}\n\n// Get data from the cache.\nasync function getCachedData(cacheName, url) {\n  const cacheStorage = await caches.open(cacheName);\n  const cachedResponse = await cacheStorage.match(url);\n\n  if (!cachedResponse || !cachedResponse.ok) {\n    return false;\n  }\n\n  return await cachedResponse.json();\n}\n\n// Delete any old caches to respect user's disk space.\nasync function deleteOldCaches(currentCache) {\n  const keys = await caches.keys();\n\n  for (const key of keys) {\n    const isOurCache = \"embedtables-\" === key.substr(0, 6);\n\n    if (currentCache === key || !isOurCache) {\n      continue;\n    }\n\n    caches.delete(key);\n  }\n}\n","import { getProjectById } from \"./api\";\n\nconst roots = document.querySelectorAll(\"div[data-embedtableid]\");\n\nfunction renderWidget(root, template, integrationName, showBranding, fields) {\n  const wrapper = document.createElement(\"div\");\n  wrapper.classList.add(template);\n\n  fields.map((row) => {\n    if (integrationName === \"airtable\") {\n      row.map((r) => {\n        if (r.name.indexOf(\"*\") > -1) {\n          r[\"order\"] = Number(r.name.split(\"*\")[0]) || 99;\n          r[\"name\"] = r.name.substring(2);\n        }\n      });\n      row = row.sort((el, el2) => el.order - el2.order);\n      console.log(row);\n    }\n\n    const rowDOM = document.createElement(\"div\");\n    const rowImageWrapper = document.createElement(\"div\");\n    const rowContentWrapper = document.createElement(\"div\");\n    rowDOM.classList.add(\"item\");\n    rowImageWrapper.classList.add(\"item__image\");\n    rowContentWrapper.classList.add(\"item__content\");\n    let buttonText = row.find((el) => el.name == \"Button_text\");\n    let buttonUrl = row.find((el) => el.name == \"Button_url\");\n    for (let i = 0; i < row.length; i++) {\n      let itemDOM = null;\n      itemDOM = document.createElement(\"div\");\n      itemDOM.classList.add(row[i].name.replace(\" \", \"-\"));\n\n      if (row[i].name == \"Button_text\" && row[i].value) {\n        const link = row.find((el) => el.name == \"Button_url\");\n        let linkValue = null;\n        if (link) {\n          linkValue = link.value || \"/\";\n        }\n        itemDOM.innerHTML = `<a href='${linkValue}'>${row[i].value}</a>`;\n        rowContentWrapper.append(itemDOM);\n      } else if (row[i].name == \"Button_url\") {\n        continue;\n      } else if (row[i].name == \"Image_url\") {\n        itemDOM.innerHTML = `<img loading=\"lazy\" src='${row[i].value ||\n          \"https://picsum.photos/300\"}'/>`;\n        rowImageWrapper.append(itemDOM);\n      } else {\n        if (row[i].value.toString().toLowerCase() === \"true\") {\n          itemDOM.innerHTML = `<span style=\"color:green\">&#10003;</span>`;\n        } else if (row[i].value.toString().toLowerCase() === \"false\") {\n          itemDOM.innerHTML = `<span style=\"color:red\">&#10007;</span>`;\n        } else {\n          if (row[i].styles) {\n            itemDOM.innerHTML = `<span style='font-style: ${row[i].styles\n              .textFormat.italic && \"italic\"};font-weight:${row[i].styles\n              .textFormat.bold && \"800\"};text-decoration: ${row[i].styles\n              .textFormat.underline && \"underline\"}'>${row[i].formattedValue ||\n              \"\"}</span>`;\n          } else {\n            itemDOM.innerHTML = `<span>${row[i].formattedValue ||\n              row[i].value ||\n              \"\"}</span>`;\n          }\n        }\n        rowContentWrapper.append(itemDOM);\n      }\n      rowDOM.append(rowImageWrapper);\n      rowDOM.append(rowContentWrapper);\n    }\n    wrapper.append(rowDOM);\n  });\n  root.append(wrapper);\n  if (showBranding) {\n    const brandingDOM = document.createElement(\"div\");\n    brandingDOM.innerHTML = `<div class=\"braning-wrapper\"><span class=\"branding\">Made with </span><a href=\"https://embedtables.com\"><img src=\"https://app.embedtables.com/static/media/logo.8fd74efc.svg\" width=\"20px\" alt=\"embedtables\"/></a></div>`;\n    root.append(brandingDOM);\n  }\n}\nimport styles from \"./et-templates-style.css\";\nimport loaderStyles from \"./loader-style.css\";\n\n(async function() {\n  roots.forEach(async function(root) {\n    root.innerHTML = `<div class=\"lds-ripple-wrapper\"><div class=\"lds-ripple\"><div></div><div></div></div></div><style>${loaderStyles}</style>`;\n    const data = await getProjectById(root.dataset[\"embedtableid\"]);\n    root.innerHTML = `\n    <style>${styles}</style> \n    `;\n    root.style.setProperty(\"--primary-color\", data.primaryColor);\n    root.style.setProperty(\"--secondary-color\", data.secondaryColor);\n    renderWidget(\n      root,\n      data.templateSlug,\n      data.integrationName,\n      data.showBranding,\n      data.fields\n    );\n  });\n})();\n"]}